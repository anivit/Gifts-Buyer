<h2 align="center">
  Telegram Gifts Auto-Buyer<br/>
</h2>

Этот user-bot автоматизирует процесс отправки подарков пользователям в Telegram.
Бот отправляет подарки конкретным пользователям и может быть настроен для работы как с лимитированными, так и с обычными подарками.
Также он управляется набором конфигураций, которые контролируют поведение бота, таких как лимит цены подарка, анонимность отправителя и многое другое.

## Содержание
- [Общая конфигурация](#общая-конфигурация)
- [Настройки](#настройки)
- [Файлы и пути данных](#файлы-и-пути-данных)
- [Подарки и информация о пользователях](#подарки-и-информация-о-пользователях)
- [Пользовательские настройки](#пользовательские-настройки)
- [Как использовать](#как-использовать)
- [Проблемы](#проблемы)

## Общая конфигурация

### `SESSION`
- **Описание**: Путь к файлу сессии, используемому ботом для хранения данных сессии.
- **По умолчанию**: `"data/account"`

### `API_ID` & `API_HASH`
- **Описание**: Ваши API ID и HASH для Telegram. Чтобы получить эти данные, необходимо создать приложение на [сайте Telegram](https://my.telegram.org/auth).

## Настройки

### `INTERVAL`
- **Описание**: Интервал времени (в секундах) между каждым проверкой новых подарков.
- **По умолчанию**: `10` _Установите значение не менее 10, чтобы избежать ошибок подключения._

### `TIMEZONE`
- **Описание**: Часовой пояс, в котором работает бот. Используется для времени, логирования и других операций.
- **По умолчанию**: `"Europe/Moscow"`

### `CHANNEL_ID`
- **Описание**: ID канала Telegram, в который бот будет отправлять уведомления о подарках или ошибках.

## Файлы и пути данных

### `DATA_FILEPATH`
- **Описание**: Путь к файлу, в котором бот хранит историю отправленных подарков.
- **По умолчанию**: `"data/history.json"`

## Подарки и информация о пользователях

### `USER_ID`
- **Описание**: Список ID пользователей, которым бот будет отправлять подарки. Пользователи должны быть в контактах с ботом (т.е. бот и пользователь должны быть в одной группе или канале).

### `MAX_GIFT_PRICE`
- **Описание**: Максимально допустимая цена подарка. Бот будет отправлять только подарки, стоимость которых ниже этого лимита.
- **По умолчанию**: `100`

### `PURCHASE_NON_LIMITED_GIFTS`
- **Описание**: Если `True`, бот будет покупать неограниченные подарки, как только они появятся, при этом соблюдая лимит цены подарка.
- **По умолчанию**: `False`

### `HIDE_SENDER_NAME`
- **Описание**: Если `True`, бот будет скрывать своё имя при отправке подарка пользователю.
- **По умолчанию**: `True`

### `GIFT_IDS`
- **Описание**: Список конкретных ID подарков, которые бот будет отправлять. Этот параметр необязателен.

### `NUM_GIFTS`
- **Описание**: Количество подарков, которые вы хотите, чтобы бот купил. **Одно количество для всех подарков!**
- **По умолчанию**: `1`

## Пользовательские настройки

### Настройка
- Вы можете изменять значения параметров `USER_ID`, `MAX_GIFT_PRICE` и `PURCHASE_NON_LIMITED_GIFTS` прямо в файле конфигурации, чтобы настроить, кому и какие подарки будет отправлять бот.
- Установите `PURCHASE_NON_LIMITED_GIFTS` в `False`, если не хотите, чтобы бот автоматически покупал неограниченные подарки.

## Как использовать

1. Клонируйте или скачайте репозиторий.
2. Убедитесь, что у вас установлен Python 3.10 или более поздняя версия.
3. Установите зависимости, выполнив команду:

    ```bash
    pip install -r requirements.txt
    ```

4. Отредактируйте файл `.env`, чтобы добавить ваши API данные, ID пользователей, ID подарков и другие настройки.
5. Запустите бота:

    ```bash
    python main.py
    ```

Бот начнёт отправлять подарки в соответствии с настройками. Он будет проверять новые подарки через заданный интервал (`INTERVAL`) и отправлять их указанным пользователям. Уведомления будут отправляться в Telegram канал, указанный в `CHANNEL_ID`.

## Проблемы

### №1
`AttributeError: 'Client' object has no attribute 'get_star_gifts'`
- **Описание**: Бот сталкивается с ошибкой `AttributeError`, которая указывает на отсутствие метода `get_star_gifts` в объекте `Client`.
- **Инфо**: Эта ошибка возникает, когда установленная версия библиотеки `pyrogram` не включает метод `get_star_gifts`, что может быть связано с устаревшей или некорректной версией библиотеки.
  

  **Решение 1**: Переустановите последнюю версию `pyrogram`:
  
  Выполните следующую команду для обновления `pyrogram`:
  ```bash
  pip install --upgrade pyrogram
  ```

  ```bash
  pip install pyrogram[pyrofork]
  ```

  **Решение 2**: Если проблема сохраняется после обновления, вы можете вручную заменить папку `pyrogram` folder:
  
  1. Скачайте [pyrogram.zip](https://github.com/user-attachments/files/17693486/pyrogram.zip).
  2. Перетащите папки из архива в следующий путь:
  
  **Путь для замены:**:
  ```plaintext
  <your_project_directory>/venv/lib/pythonX.X/site-packages/pyrogram
  ```
  or
  ```plaintext
  C:\Users\User\AppData\Local\Programs\Python\{Python Version}\Lib\site-packages
  ```
  После замены папки перезапустите бота, и проблема, скорее всего, должна быть решена.


[//]: # (### №2  )

[//]: # (`Telegram says: [400 PEER_ID_INVALID]  Pyrogram 2.3.48 thinks: The peer id being used is invalid or not known yet. Make sure you meet the peer before interacting with it`)

[//]: # (- **Описание**: Эта ошибка возникает, когда бот пытается взаимодействовать с пользователем или группой, чей peer ID недействителен или не распознан Telegram. Это обычно происходит, если бот еще не взаимодействовал с пользователем напрямую &#40;например, не находится в одном чате или группе&#41; или peer ID еще не был известен Telegram.)

[//]: # (- **Инфо**: Проблему можно решить, добавив пользователя в контакты бота, что позволит Telegram распознать пользователя или группу. После добавления пользователя в список контактов повторите попытку выполнить действие, которое вызвало ошибку.)

[//]: # ()
[//]: # (  **Решение 1**: Убедитесь, что пользователь каким-либо образом взаимодействовал с ботом &#40;например, присоединился к общему чату или отправил сообщение боту&#41;, чтобы установить действительный peer ID. Если этого не произошло, выполните следующее решение.)

[//]: # (  )
[//]: # (  **Решение 2**:)

[//]: # (  )
[//]: # (  1. Раскомментируйте блок кода в файле `main.py` с 37 по 47 строку и закомментируйте блок выше.)

[//]: # (  2. В файле `.env` укажите имя пользователя вот так: `'B7XX7B'`. Обязательно используйте кавычки!)

[//]: # (  )
[//]: # (  Перезапустите бота, и проблема, скорее всего, будет решена.)

---
## Лицензия

Этот проект лицензирован под лицензией MIT - см. файл LICENSE для подробностей.
